<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Contact</title>

	<style>
:root {
	--u: 1.5vw;
	--bg: #070708;
	--fg: #1b1b1c;
	--border-clr: #424244;
	--glow-size: calc(20 * var(--u));
	--glow-clr: #f5f5ff77;
	--glow-clr2: #f5f5ff44;
	--border: calc(.3 * var(--u));
	--br: calc(1 * var(--u));
}
html {
	height: 100%;
}
body {
	margin: 0;
	background: var(--bg);
	height: 100%;
	display: flex;
	flex-direction: column;
}
header {
	text-align: center;
	color: #fff;
	font-family: Arial, sans-serif;
	font-weight: 500;
	padding-top: calc(3 * var(--u));
	padding-bottom: calc(2 * var(--u));
}
header .glow-wrapper {
	width: fit-content;
	margin: 0 auto;
}
header #title {
	width: min-content;
	padding: calc(1 * var(--u)) calc(2 * var(--u));
	background: var(--fg);
	border-radius: var(--br);
}
header #title h1 {
	margin: 0;
	font-size: calc(3 * var(--u));
}
header p {
	width: 75%;
	margin: 0 auto;
	margin-top: calc(1.8 * var(--u));
	font-size: calc(1.5 * var(--u));
	line-height: calc(2 * var(--u));
}
header h1::selection, header p::selection {
	background-color: #bbb7;
}
main {
	display: flex;
	flex-direction: column;
	height: 100%;
	margin: 0 calc(3 * var(--u));
	margin-bottom: calc(5 * var(--u));
	flex: 1;
	gap: calc(1 * var(--u));
}
.glow-wrapper {
	background-color: var(--border-clr);
	background-image: radial-gradient(
	circle at var(--x) var(--y),
	var(--glow-clr), transparent var(--glow-size));
	background-attachment: fixed;
	width: 100%;
	height: max-content;
	height: auto;
	box-sizing: border-box;
	padding: var(--border);
	border-radius: calc(var(--br) + var(--border));
}
#info {
	display: grid;
	grid-template-columns: 4fr 1fr;
	grid-template-rows: 1fr 1fr;
	gap: calc(1 * var(--u));
}
#info .glow-wrapper:nth-child(1) {
	grid-area: 1 / 1 / 2 / 2;
}
#info .glow-wrapper:nth-child(2) {
	grid-area: 2 / 1 / 3 / 2;
}
#info .glow-wrapper:nth-child(3) {
	grid-area: 1 / 2 / 3 / 3;
}
#info .glow-wrapper {
	height: 100%;
}
#info .glow-wrapper input[type="text"], #info .glow-wrapper button {
	height: 100%;
}
textarea, input[type="text"], button {
	width: 100%;
	box-sizing: border-box;
	border-radius: var(--br);
	background: var(--fg);
	border: none;
	margin: 0;
	padding: calc(1.5 * var(--u));
	padding-left: calc(1.25 * var(--u));
	color: #fff;
	font-family: Arial;
	font-weight: 500;
	font-size: calc(2 * var(--u));
}
textarea::selection, input[type="text"]::selection, button::selection {
	background-color: #bbb7;
}
textarea:focus, input[type="text"]:focus, button:focus {
	outline: var(--border) solid var(--glow-clr2);
}
#msg-wrapper {
	flex: 1;
}
#msg {
	resize: none;
	height: 100%;
	padding: calc(2 * var(--u));
	padding-left: calc(1.75 * var(--u));
	font-size: calc(2.5 * var(--u));
}
button {
	padding: 0;
}
#success, #error {
	width: 80%;
	margin: 0 auto;
	box-sizing: border-box;
}
#success p, #error p {
	width: 100%;
	box-sizing: border-box;
	border-radius: var(--br);
	background: var(--fg);
	margin: 0;
	padding: calc(1.5 * var(--u));
	color: #fff;
	font-family: Arial;
	font-weight: 500;
	font-size: calc(2 * var(--u));
}
#success p::selection, #error p::selection {
	background-color: #bbb7;
}
.underlined {
	color: #fff;
	font-family: Arial;
	font-weight: 500;
	position: relative;
	transition: .2s;
	z-index: 2;
	text-decoration: none;
}
.underline {
	--widen: 0%;
	--fix: 0%;
	width: calc(100% + var(--widen));
	transform: translateX(calc(-100% + var(--fix)));
	height: 1px;
	background: #fff;
	position: absolute;
	bottom: 0;
	transition: .2s;
	z-index: -1;
}
.underlined:hover {
	color: #000;
}
.underlined:hover .underline {
	height: 100%;
}
.underlined::selection {
	background: #ffffff55;
}
@media only screen and (min-aspect-ratio: 1/1) {
	:root {
		--u: 1.2vh;
	}
}
*[hidden] {
	display: none;
}
	</style>
</head>
<body>
	<header>
		<div class="glow-wrapper">
			<div id="title">
				<h1>contact.qwk.zone</h1>
			</div>
		</div>
		<p>
			Please note that all messages are public,
			apart from the specific "private" field
			for usernames or emails.
		</p>
	</header>

	<main id="main">
		<div id="msg-wrapper" class="glow-wrapper">
			<textarea id="msg" placeholder="Enter message here..."></textarea>
		</div>
		<div id="info">
			<div class="glow-wrapper">
				<input type="text" id="name" placeholder="Name">
			</div>
			<div class="glow-wrapper">
				<input type="text" id="private" placeholder="Private Info (Email, Discord, Etc)">
			</div>
			<div class="glow-wrapper">
				<button id="sumbit" onclick="send()">Send</button>
			</div>
		</div>
	</main>

	<div class="glow-wrapper" id="success" hidden>
		<p>
			Your message has been sent and is viewable 
			<span><a class="underlined" href="/">here<span class="underline" style="--widen: 3%; --fix: 1.7%;"></span></a></span><br>
			Check back as I'll respond as soon as I can
		</p>
	</div>
	<div class="glow-wrapper" id="error" hidden>
		<p>
			Failed to send message<br>
			<span id="traceback"></span><br>
			Please try again (later)
		</p>
	</div>

	<script>
		const REF = window.location.pathname.slice(1);

		document.addEventListener('mousemove', e => {
			document.body.style.setProperty('--x', `${e.x}px`);
			document.body.style.setProperty('--y', `${e.y}px`);
		});

		const after = {
			main: document.getElementById('main'),
			success: document.getElementById('success'),
			error: document.getElementById('error'),
			traceback: document.getElementById('traceback')
		}

		const msg = document.getElementById('msg');
		const name = document.getElementById('name');
		const private = document.getElementById('private');
		function send() {
			if (!msg.value || !name.value || !private.value) return;
			fetch('https://qwk.pythonanywhere.com/contact/send', {
				method: 'POST',
				headers: {
					"Content-Type": "application/json"
				},
				body: JSON.stringify({
					ref: REF,
					msg: msg.value,
					name: name.value,
					private: private.value
				})
			})
				.then(resp => resp.json())
				.then(data => {
					after.main.hidden = true;
					after.success.hidden = !data.success;
					after.error.hidden = data.success;
					after.traceback.innerText = data.error || '';
				})
				.catch(e => {
					after.main.hidden = true;
					after.success.hidden = true;
					after.error.hidden = false;
					after.traceback.innerText = e || '';
				})
		}
	</script>
</body>
</html>
